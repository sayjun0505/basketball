import{r as d,an as p}from"./index-cy1M6gwN.js";function v(n){if(typeof window>"u")return n;const t=d.useRef(null);return d.useLayoutEffect(()=>{t.current=n}),d.useCallback((...r)=>{var s;(s=t.current)===null||s===void 0||s.call(t,...r)},[])}const N={};function A(n,t){N[n]||(N[n]=!0,console.error("[material-ui-popup-state] WARNING",t))}const M={isOpen:!1,setAnchorElUsed:!1,anchorEl:void 0,anchorPosition:void 0,hovered:!1,focused:!1,_openEventType:null,_childPopupState:null,_deferNextOpen:!1,_deferNextClose:!1};function q({parentPopupState:n,popupId:t,variant:r,disableAutoFocus:s}){const f=d.useRef(!0);d.useEffect(()=>(f.current=!0,()=>{f.current=!1}),[]);const[c,a]=d.useState(M),i=d.useCallback(o=>{f.current&&a(o)},[]),g=d.useCallback(o=>i(e=>({...e,setAnchorElUsed:!0,anchorEl:o??void 0})),[]),F=v(o=>(c.isOpen?m(o):P(o),c)),P=v(o=>{const e=o instanceof Element?void 0:o,u=o instanceof Element?o:(o==null?void 0:o.currentTarget)instanceof Element?o.currentTarget:void 0;if((e==null?void 0:e.type)==="touchstart"){i(l=>({...l,_deferNextOpen:!0}));return}const T=e==null?void 0:e.clientX,_=e==null?void 0:e.clientY,U=typeof T=="number"&&typeof _=="number"?{left:T,top:_}:void 0,y=l=>{if(!o&&!l.setAnchorElUsed&&r!=="dialog"&&A("missingEventOrAnchorEl","eventOrAnchorEl should be defined if setAnchorEl is not used"),n){if(!n.isOpen)return l;setTimeout(()=>n._setChildPopupState(b))}const E={...l,isOpen:!0,anchorPosition:U,hovered:(e==null?void 0:e.type)==="mouseover"||l.hovered,focused:(e==null?void 0:e.type)==="focus"||l.focused,_openEventType:e==null?void 0:e.type};return e!=null&&e.currentTarget?l.setAnchorElUsed||(E.anchorEl=e==null?void 0:e.currentTarget):u&&(E.anchorEl=u),E};i(l=>l._deferNextOpen?(setTimeout(()=>i(y),0),{...l,_deferNextOpen:!1}):y(l))}),h=o=>{const{_childPopupState:e}=o;return setTimeout(()=>{e==null||e.close(),n==null||n._setChildPopupState(null)}),{...o,isOpen:!1,hovered:!1,focused:!1}},m=v(o=>{const e=o instanceof Element?void 0:o;if((e==null?void 0:e.type)==="touchstart"){i(u=>({...u,_deferNextClose:!0}));return}i(u=>u._deferNextClose?(setTimeout(()=>i(h),0),{...u,_deferNextClose:!1}):h(u))}),S=d.useCallback((o,e)=>{o?P(e):m(e)},[]),k=v(o=>{const{relatedTarget:e}=o;i(u=>u.hovered&&!(e instanceof Element&&C(e,b))?u.focused?{...u,hovered:!1}:h(u):u)}),w=v(o=>{if(!o)return;const{relatedTarget:e}=o;i(u=>u.focused&&!(e instanceof Element&&C(e,b))?u.hovered?{...u,focused:!1}:h(u):u)}),B=d.useCallback(o=>i(e=>({...e,_childPopupState:o})),[]),b={...c,setAnchorEl:g,popupId:t,variant:r,open:P,close:m,toggle:F,setOpen:S,onBlur:w,onMouseLeave:k,disableAutoFocus:s??!!(c.hovered||c.focused),_setChildPopupState:B};return b}function x({isOpen:n,popupId:t,variant:r}){return{...r==="popover"?{"aria-haspopup":!0,"aria-controls":n&&t!=null?t:void 0}:r==="popper"?{"aria-describedby":n&&t!=null?t:void 0}:void 0}}function W(n){return{...x(n),onClick:n.open,onTouchStart:n.open}}function X(n){return{...x(n),onClick:n.toggle,onTouchStart:n.toggle}}function Y({isOpen:n,anchorEl:t,anchorPosition:r,close:s,popupId:f,onMouseLeave:c,disableAutoFocus:a,_openEventType:i}){return{id:f,anchorEl:t,anchorPosition:r,anchorReference:i==="contextmenu"?"anchorPosition":"anchorEl",open:n,onClose:s,onMouseLeave:c,...a&&{disableAutoFocus:!0,disableEnforceFocus:!0,disableRestoreFocus:!0}}}function j({isOpen:n,anchorEl:t,anchorPosition:r,close:s,popupId:f,onMouseLeave:c,disableAutoFocus:a,_openEventType:i}){return{id:f,anchorEl:t,anchorPosition:r,anchorReference:i==="contextmenu"?"anchorPosition":"anchorEl",open:n,onClose:s,onMouseLeave:c,...a&&{autoFocus:!1,disableAutoFocusItem:!0,disableAutoFocus:!0,disableEnforceFocus:!0,disableRestoreFocus:!0}}}function G({isOpen:n,anchorEl:t,popupId:r,onMouseLeave:s}){return{id:r,anchorEl:t,open:n,onMouseLeave:s}}function I(n,{popupId:t}){if(!t)return null;const r=typeof n.getRootNode=="function"?n.getRootNode():document;return typeof r.getElementById=="function"?r.getElementById(t):null}function C(n,t){const{anchorEl:r,_childPopupState:s}=t;return R(r,n)||R(I(n,t),n)||s!=null&&C(n,s)}function R(n,t){if(!n)return!1;for(;t;){if(t===n)return!0;t=t.parentElement}return!1}function L({children:n,popupId:t,variant:r,parentPopupState:s,disableAutoFocus:f}){const c=q({popupId:t,variant:r,parentPopupState:s,disableAutoFocus:f}),a=n(c);return a??null}L.propTypes={children:p.func.isRequired,popupId:p.string,variant:p.oneOf(["popover","popper"]).isRequired,parentPopupState:p.object,disableAutoFocus:p.bool};export{L as P,j as a,W as b,Y as c,X as d,G as e};
